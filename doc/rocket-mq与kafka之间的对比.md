## 1、写入性能对比

1、rocket-mq对于写入是采用的是同步和异步方式，由于业务中使用的都是同步方式，所以broker都采用的是同步方式。

> ​	具体下面不懂的参考：[CommitLog和ConsumerQueue和IndexFile源码分析](./CommitLog和ConsumerQueue和IndexFile分析.md)

- 写入的时候每个broker，都会去顺写commit-log 日志文件，这个文件采用append的方式，所有的topic都在一个commit-log日志下，如果大小大于设置的阈值，则会创建一个新的
- 写入 `consumer-log`采用异步的方式，开启一个线程，定期的扫描commit-log日志文件，写入topic信息 （以每个topic-queue）进行隔离
- 写入`index-file`也是采用的异步的方式，跟`consumer-log`一样（每个broker写入一个文件）

2、kafka





## 2、读取性能对比

1、对于上面写解释来说，rocket-mq采用的是 `mmap`技术，对于读取每条消息来说，他会先去读取`consumer-log`然后查看到偏移量，然后读取 `commit-log`，对于读写基本一致的情况下(由于采用mmap方式，如果数据刚好在内存中，性能会提升很多)，读取性能会高一些，但是它对于随机读取文件的能力也会要求高一些，所以推荐使用ssd作为存储

2、



## 3、源码难度和质量

1、kafka的代码写的很优秀，核心代码采用的`scala`语言作为主要开发语言，学习难度会较高，其次是代码的开源质量来说很高，本人学习的是`2.1.1`版本

2、rocket-mq 的代码质量整体来说，可以说是中等，对于一些核心实现来说可以值得学习一下，但是代码注释欠缺太多，可以看出来很多代码是阿里未开源的，但是代码难度来说可以说是偏于简单。代码冗余也稍微多一些。学习版本是`4.8.0`

3、kafka本地代码环境不好搭建，使用的`gradle`管理工具

